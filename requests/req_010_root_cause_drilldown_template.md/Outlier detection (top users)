SELECT
  user_id,
  SUM(revenue_amount) AS revenue
FROM `project.dataset.payments`
WHERE DATE(payment_date) >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY)
GROUP BY 1
ORDER BY revenue DESC
LIMIT 20;
