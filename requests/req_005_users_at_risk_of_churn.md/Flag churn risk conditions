SELECT
  user_id,
  days_since_last_payment,
  tx_last_30d,
  tx_before_30d,
  revenue_last_30d,
  revenue_before_30d,
  historical_arppu,

  -- Risk flags
  CASE WHEN days_since_last_payment > 30 THEN 1 ELSE 0 END AS inactive_flag,
  CASE WHEN tx_last_30d < tx_before_30d THEN 1 ELSE 0 END AS frequency_drop_flag,
  CASE WHEN revenue_last_30d < revenue_before_30d THEN 1 ELSE 0 END AS revenue_drop_flag

FROM risk_signals;
